/*! vy 2015-09-01 */
(function(){var a,b,c,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}};d=function(a,b){var c,d;for(d in b)c=b[d],a[d]=c;return a},c=function(a){var b;return b=document.createElement("div"),b.innerHTML=a,b.childNodes[0]},e=function(a){return alert("implement offset()")},this.Vy=function(){function c(c,e){var g;null==e&&(e={}),this.hook=f(this.hook,this),g={buttons:{left:["rewind"],right:["sound"]}},g=d(g,e),this.View=new b(c,g),this.Events=new a(this,this.View),this.hook(this.View.component("root"))}return c.prototype.hook=function(a){return a.vy=this},c.prototype.getCurrentTimePercent=function(){var a;return a=this.View.component("player"),a.currentTime/a.duration},c.prototype.movePlaySliderToPercent=function(a){return this.moveSliderToPercent(this.View.component("play-slider"),a)},c.prototype.moveLoadSliderToPercent=function(a){return this.moveSliderToPercent(this.View.component("load-slider"),a)},c.prototype.moveSliderToPercent=function(a,b){return b>=1&&(b=1),a.style.right=100-100*b+"%"},c.prototype.seekToPercent=function(a){var b;return b=this.View.component("player"),this.seekToDuration(a*b.duration)},c.prototype.seekToDuration=function(a){return this.View.component("player").currentTime=a},c.prototype.getSeekPercent=function(a){var b;return b=this.View.component("player"),(a-e(b).left)/b.width()},c.prototype.play=function(){return this.View.component("player").play()},c.prototype.pause=function(){return this.View.component("player").pause()},c.prototype.mute=function(){return this.View.component("player").setAttribute("muted","muted"),this.root.setAttribute("muted","muted")},c.prototype.unmute=function(){return this.View.component("player").removeAttribute("muted"),this.root.removeAttribute("muted")},c.prototype.enablePauseButton=function(){return hide(this.View.component("play")),show(this.View.component("pause"))},c.prototype.enablePlayButton=function(){return hide(this.View.component("pause")),show(this.View.component("play"))},c.prototype.setAsPlaying=function(){return this.View.root.setAttribute("playing","playing")},c.prototype.setAsPaused=function(){return this.View.root.removeAttribute("playing")},c.prototype.isMuted=function(){return!!this.View.component("player").getAttribute("muted")},c.prototype.isPlaying=function(){var a;return"playing"===(null!=(a=this.View.root)?a.getAttribute("playing"):void 0)},c.prototype.toggleMute=function(){return this.isMuted()?this.unmute():this.mute()},c.prototype.trigger=function(a){return this.View.component("player").dispatchEvent(new Event(a))},c}(),window.addEventListener("load",function(a){var b,c,d,e,f,g;for(d=document.querySelectorAll(".vy-video"),e=[],b=0,c=d.length;c>b;b++)g=d[b],f=JSON.parse(g.getAttribute("data-vy-settings")),e.push(g.vy=new Vy(g,f));return e}),"undefined"!=typeof $&&null!==$&&($.fn.vy=function(a){return null==a&&(a={}),this.each(function(b,c){return null==c.vy&&(c.vy=new Vy(c,a)),c})}),a=function(){function a(a,b){this.View=b,this.Vy=a,this.init()}var b;return b={MouseDownOnVideo:!1,MovingSlider:!1},a.prototype.init=function(){return this.View.component("root").addEventListener("mouseleave",function(a){return function(a){return b.MovingSlider=!1,b.MouseDownOnVideo=!1}}(this)),this.View.component("play").addEventListener("click",function(a){return function(b){return b.preventDefault(),a.Vy.play()}}(this)),this.View.component("pause").addEventListener("click",function(c){return function(d){return d.preventDefault(),a.MovingSlider?(c.Vy.seekToPercent(c.Vy.getSeekPercent(d.clientX)),c.Vy.play()):c.Vy.pause(),b.MovingSlider=!1,b.MouseDownOnVideo=!1}}(this)),this.View.component("pause").addEventListener("mousedown",function(a){return function(a){return a.preventDefault(),b.MouseDownOnVideo=!0}}(this)),this.View.component("pause").addEventListener("mousemove",function(a){return function(c){var d;return c.preventDefault(),b.MouseDownOnVideo?(b.MovingSlider=!0,d=a.Vy.getSeekPercent(c.clientX),a.Vy.seekToPercent(d),a.Vy.movePlaySliderToPercent(d)):void 0}}(this)),this.View.component("player").addEventListener("progress",function(a){return function(b){var c,d;return c=null!=(d=a.buffered)?d.end(0):void 0,c!==a.duration?a.Vy.moveLoadSliderToPercent(c):void 0}}(this)),this.View.component("rewind").addEventListener("click",function(a){return function(b){return b.stopPropagation(),a.Vy.seekToDuration(0)}}(this)),this.View.component("sound").addEventListener("click",function(a){return function(b){return b.stopPropagation(),a.Vy.toggleMute()}}(this)),this.View.component("player").addEventListener("play",function(a){return function(b){return a.Vy.setAsPlaying()}}(this)),this.View.component("player").addEventListener("pause",function(a){return function(b){return a.Vy.setAsPaused()}}(this)),this.View.component("player").addEventListener("currenttimeupdate",function(a){return function(b){return a.Vy.movePlaySliderToPercent(a.Vy.getCurrentTimePercent())}}(this)),setInterval(function(a){return function(){return a.Vy.isPlaying()?a.Vy.trigger("currenttimeupdate"):void 0}}(this),20)},a}(),b=function(){function a(a,b){this.componentCache={},this.root=this.buildPlayer(a,b),this.insertButtons(b.buttons),this.insertTitle(b.title)}var b,d;return d='<div class="vy"> <div class="vy-title"></div> <div class="vy-positioner"> <video class="vy-placeholder"></video> </div> <div class="vy-controls"> <div class="vy-play"></div> <div class="vy-pause"></div> <div class="vy-buttons vy-buttons-left"></div> <div class="vy-buttons vy-buttons-right"></div> <div class="vy-play-slider"></div> <div class="vy-load-slider"></div> </div> </div>',b='<div class="vy-button"></div>',a.prototype.buildPlayer=function(a,b){var e,f,g;return f=a.cloneNode(!0),f.classList.add("vy-player"),g=c(d,!0),e=g.querySelector("video.vy-placeholder"),e.parentNode.replaceChild(f,e),a.parentNode.replaceChild(g,a),g},a.prototype.insertButtons=function(a){var d,e,f,g,h,i,j,k,l;for(f=c(b),j=Object.keys(a),k=[],h=0,i=j.length;i>h;h++)g=j[h],l=this.component("buttons-"+g),"right"===g&&a[g].reverse(),k.push(function(){var b,c,h,i;for(h=a[g],i=[],b=0,c=h.length;c>b;b++)d=h[b],e=f.cloneNode(!0),e.classList.add("vy-"+d),e.textContent=d,i.push(l.appendChild(e));return i}());return k},a.prototype.insertTitle=function(a){return(null!=a?a.length:void 0)?this.component("title").textContent=a:void 0},a.prototype.component=function(a,b){var c;return null==b&&(b=!0),a in this.componentCache?this.componentCache[a]:(c="root"===a?this.root:this.root.querySelector(".vy-"+a),this.componentCache[a]=c)},a}()}).call(this);