/*! vy 2015-06-24 */
(function(){this.Vy=function(){function a(a,c){var d;null==c&&(c={}),d={buttons:{playing:["rewind"],hovering:["sound"]}},d=$.extend(d,c),this.root=this.buildPlayer(a,d),this.root.data("vy",this),this.insertButtons(d.buttons),this.root.on("mouseleave",function(a){return function(a){return b.MovingSlider=!1,b.MouseDownOnVideo=!1}}(this)),this.component("play").on("click",function(a){return function(b){return b.preventDefault(),a.play()}}(this)),this.component("pause").on("click",function(a){return function(c){return c.preventDefault(),b.MovingSlider?(a.seekToPercent(a.getSeekPercent(c.clientX)),a.play()):a.pause(),b.MovingSlider=!1,b.MouseDownOnVideo=!1}}(this)),this.component("pause").on("mousedown",function(a){return function(a){return a.preventDefault(),b.MouseDownOnVideo=!0}}(this)),this.component("pause").on("mousemove",function(a){return function(c){var d;return c.preventDefault(),b.MouseDownOnVideo?(b.MovingSlider=!0,d=a.getSeekPercent(c.clientX),a.seekToPercent(d),a.movePlaySliderToPercent(d)):void 0}}(this)),this.component("player").on("progress",function(a){return function(b){var c,d;return c=null!=(d=a.buffered)?d.end(0):void 0,c!==a.duration?self.moveLoadSliderToPercent(c):void 0}}(this)),this.component("rewind").on("click",function(a){return function(b){return b.stopPropagation(),a.seekToDuration(0)}}(this)),this.component("sound").on("click",function(a){return function(b){return b.stopPropagation(),a.toggleMute()}}(this)),this.component("player").on("play",function(a){return function(b){return a.setAsPlaying()}}(this)),this.component("player").on("pause",function(a){return function(b){return a.setAsPaused()}}(this)),this.component("player").on("currenttimeupdate",function(a){return function(b){return a.movePlaySliderToPercent(a.getCurrentTimePercent())}}(this)),setInterval(function(a){return function(){return a.isPlaying()?a.component("player").trigger("currenttimeupdate"):void 0}}(this),20)}var b,c,d;return d='<div class="vy"> <div class="vy-positioner"> <video class="vy-placeholder"></video> </div> <div class="vy-controls"> <div class="vy-play"></div> <div class="vy-pause"></div> <div class="vy-when-playing"></div> <div class="vy-when-hovering right-aligned"></div> <div class="vy-play-slider"></div> <div class="vy-load-slider"></div> </div> </div>',c='<div class="vy-button"></div>',b={MouseDownOnVideo:!1,MovingSlider:!1},a.prototype.buildPlayer=function(a,b){var c,e;return c=$(a).clone().addClass("vy-player"),e=$(d).find("video.vy-placeholder").replaceWith(c).end()},a.prototype.insertButtons=function(a){var b,d,e,f,g,h,i,j;for(b=$(c),h=Object.keys(a),i=[],f=0,g=h.length;g>f;f++)e=h[f],j=this.component("when-"+e),j.hasClass("right-aligned")&&a[e].reverse(),i.push(function(){var c,f,g,h;for(g=a[e],h=[],c=0,f=g.length;f>c;c++)d=g[c],h.push(j.append(b.clone().addClass("vy-"+d).text(d)));return h}());return i},a.prototype.component=function(a){return this.root.find(".vy-"+a)},a.prototype.getCurrentTimePercent=function(){var a;return a=this.component("player").get(0),a.currentTime/a.duration},a.prototype.movePlaySliderToPercent=function(a){return a>=1&&(a=1),this.component("play-slider").css("right",100-100*a+"%")},a.prototype.moveLoadSliderToPercent=function(a){return a>=1&&(a=1),this.component("load-slider").css("right",100-100*a+"%")},a.prototype.seekToPercent=function(a){var b;return b=this.component("player").get(0),this.seekToDuration(a*b.duration)},a.prototype.seekToDuration=function(a){var b;return b=this.component("player").get(0),b.currentTime=a},a.prototype.getSeekPercent=function(a){var b,c;return b=this.component("player"),c=b.offset(),(a-c.left)/b.width()},a.prototype.play=function(){return this.component("player").get(0).play()},a.prototype.pause=function(){return this.component("player").get(0).pause()},a.prototype.mute=function(){return this.component("player").attr("muted","muted"),this.root.attr("muted","muted")},a.prototype.unmute=function(){return this.component("player").attr("muted",null),this.root.attr("muted",null)},a.prototype.enablePauseButton=function(){return this.component("play").hide(),this.component("pause").show(),this.component("when-playing").show()},a.prototype.enablePlayButton=function(){return this.component("pause").hide(),this.component("play").show(),this.component("when-playing").hide()},a.prototype.setAsPlaying=function(){return this.root.attr("playing","playing")},a.prototype.setAsPaused=function(){return this.root.attr("playing",null)},a.prototype.isMuted=function(){return!!this.component("player").attr("muted")},a.prototype.isPlaying=function(){var a;return"playing"===(null!=(a=this.root[0])?a.getAttribute("playing"):void 0)},a.prototype.toggleMute=function(){return this.isMuted()?this.unmute():this.mute()},a}(),$.fn.vy=function(a){return null==a&&(a={}),this.each(function(b,c){var d,e;return d=$(c),null==d.data("vy")&&(e=new Vy($(c)[0],a),d.replaceWith(e.root),c=e.root[0]),c})},$(function(){return $(".vy-video").vy()})}).call(this);